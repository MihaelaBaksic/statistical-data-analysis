---
title: "Big Five – velikih pet dimenzija ličnosti"
author: "Filip Grebenar, David Konjevod, Lovre Mitrović, Mihaela Bakšić"
subtitle: Projekt iz predmeta Statistička analiza podataka
output:
  html_document:
    df_print: paged
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
```


```{r}

bigfive = read.csv("./big_five_scores.csv")
head(bigfive)

```
```{r}
View(bigfive)
```
```{r}
summary(bigfive)
```



## Testiranje razlika u otvorenosti kod mladih i starih ispitanika

```{r}

cat('Medijan godina svih ispitanika je ', median(bigfive$age),'\n')

old_subjects = bigfive[bigfive$age >= 60 ,]
young_subjects = bigfive[bigfive$age <= 30 ,]

cat('Srednja vrijednost otvorenosti za mlade ( <= 30 godina ) ispitanike je ', mean(young_subjects$openness_score), '\n')
cat('Srednja vrijednost otvorenosti za stare ( >= 60 godina ) ispitanike je ', mean(old_subjects$openness_score), '\n')
cat('Varijanca otvorenosti za mlade ( <= 30 godina ) ispitanike je ', var(young_subjects$openness_score), '\n')
cat('Varijanca otvorenosti za stare ( >= 60 godina ) ispitanike je ', var(old_subjects$openness_score), '\n')

boxplot(old_subjects$openness_score, young_subjects$openness_score, 
        names = c('Older subjects\' openness score','Younger subjects\' openness score'),
        main='Boxplot of younger and older subjects\' openness score')


hist(bigfive$openness_score,main='Openness score histogram',xlab='Value',ylab='Frequency', breaks=100)


```

# Normalnost podataka - grafovi
```{r}

hist(old_subjects$openness_score,main='Openness score old subjects histogram',xlab='Value',ylab='Frequency', breaks=100)
hist(young_subjects$openness_score,main='Openness score young subjects histogram',xlab='Value',ylab='Frequency', breaks=100)

qqnorm(old_subjects$openness_score, pch = 1, frame = FALSE,main='Older subjects')
qqline(old_subjects$openness_score, col = "steelblue", lwd = 2)

qqnorm(young_subjects$openness_score, pch = 1, frame = FALSE,main='Younger subjects')
qqline(young_subjects$openness_score, col = "steelblue", lwd = 2)

```


# Testiranje normalnosti - Lillieforsova inačica Kolmogomorov-Smirnovljevog testa


Testiranje normalnosti otvorenosti za starije ispitanike
```{r}
lillie.test(old_subjects$openness_score)
```

Testiranje normalnosti faktora otvorenosti za mlađe ispitanike
```{r}
lillie.test(young_subjects$openness_score)
```

# Testiranje jednakosti varijanci otvorenosti za stare i mlade ispitanike

Testiranje jednakosti varijanci provodi se F testom. Pretpostavlja se nezavisnost uzoraka.

Hipoteze:

$$H_0: \sigma^2_{old} = \sigma^2_{young}  \\ H_1: \sigma^2_{old} \neq \sigma^2_{young}  $$
```{r}
var.test(old_subjects$openness_score, young_subjects$openness_score)
```
S obzirom da je p-vrijednost = ____ odbacujemo hipotezu \(H_0 : \sigma^2_{old} = \sigma^2_{young} \) u korist alternativne hipoteze \( H_1: \sigma^2_{old} \neq \sigma^2_{young} \). Zaključujemo da podatci govore u prilog alternativnoj hipotezi i u testovima koji slijede koristit će se informacija o nejednakosti varijanci dobivena ovim testom.

# Testiranje jednakosti srednjih vrijednosti otvorenosti za stare i mlade ispitanike

Testiranje jednakosti srednjih vrijednosti otvorenosti za stare i mlade ispitanike provodi se kao T test za podatke s različitim varijancama. Pretpostavlja se nezavisnost uzoraka.

Hipoteze:

$$H_0: \mu_{old} = \mu_{young}  \\ H_1: \mu_{old} \neq \mu_{young}  $$

```{r}
t.test(old_subjects$openness_score, young_subjects$openness_score, alt = "two.sided", var.equal = FALSE)

```
p-vrijednost je manja od 0.05, stoga se hipoteza \( H_0: \mu_{old} = \mu_{young} \) odbacuje u korist alternativne hipoteze \(H_1: \mu_{old} \neq \mu_{young}  \)


#Savjesnost između regija
U ovom dijelu bavimo se pitanjem imaju li neke regije značajno različite rezultate u određenom faktoru. Primjerice je li opravdan mit o visokoj savjesnosti populacije istočne Azije naspram populacije drugih kontinenata.

Regije sam podijelio na osnovu UN-ove podjele (izvor:"https://unstats.un.org/sdgs/indicators/regional-groups/").

```{r}

region_east_asian =c('Brunei','Cambodia','China','Hong Kong','Indonesia','Japan','Macau', 'Malaysia', 'Mongolia','Burma(Myan','North Kore', 'Philippine','Singapore','South Kore','Burma', 'Thailand','Vietnam', 'Taiwan','Borneo')

east_asia = bigfive[bigfive$country == region_east_asian,]

rest_regions = bigfive[bigfive$country != region_east_asian,]
```

```{r}
summary(bigfive$conscientiousness_score)
summary(east_asia$conscientiousness_score)
summary(rest_regions$conscientiousness_score)

cat('Varijanca savjesnosti za istočnu aziju ', var(east_asia$conscientiousness_score), '\n')
cat('Varijanca savjesnosti za ostatak svijeta ', var(rest_regions$conscientiousness_score), '\n')

boxplot(east_asia$conscientiousness_score, rest_regions$conscientiousness_score, 
        names = c('Istočna Azija\ savjesnost','Ostatak svijeta\' savjesnost'),
        main='Boxplot za istočnu Aziju i ostatak svijeta\' savjesnost')


hist(bigfive$conscientiousness_score,main='Savjesnost histogram',xlab='Value',ylab='Frequency', breaks=100)

```

```{r}

hist(east_asia$conscientiousness_score,main='Histogram savjesnosti istočne Azije',xlab='Value',ylab='Frequency', breaks=100)
hist(rest_regions$conscientiousness_score,main='Histogram savjesnosti ostatka svijeta',xlab='Value',ylab='Frequency', breaks=100)

qqnorm(east_asia$conscientiousness_score, pch = 1, frame = FALSE,main='Istočna Azija')
qqline(east_asia$conscientiousness_score, col = "steelblue", lwd = 2)

qqnorm(rest_regions$conscientiousness_score, pch = 1, frame = FALSE,main='Ostatak svijeta')
qqline(rest_regions$conscientiousness_score, col = "steelblue", lwd = 2)

```
Već iz priloženih grafova mogu naslutiti da su obje distribucije normalne, da je rasipanje veće kod populacije istočne Azije nego u ostatku svijeta (pretpostavljam da je to najviše zbog činjenice da je set podataka za ostatak svijeta mnogo veći) te suprotno početnom pitanju izgleda da je savjesnost ispitanika istočne Azije manja nego u ostatku svijeta.

#Testiranje normalnosti distribucije savjesnosti

Hipoteze:

H_0: distribucija east_asia$conscientiousness_score pripada eksponencijalnoj razdiobi
H_1: distribucija east_asia$conscientiousness_score NE pripada eksponencijalnoj razdiobi

```{r}
lillie.test(east_asia$conscientiousness_score)
```
Odbacujem nultu hipotezu u korist alternative da se savjesnost ispitanaika istočne Azije ravna po normalnoj distribuciji.

Hipoteze:

H_0: distribucija rest_regions$conscientiousness_score pripada eksponencijalnoj razdiobi
H_1: distribucija rest_regions$conscientiousness_score NE pripada eksponencijalnoj razdiobi

```{r}
lillie.test(rest_regions$conscientiousness_score)
```
Odbacujem nultu hipotezu u korist alternative da se savjesnost ispitanika iz ostalih regija ravna po normalnoj distibuciji.

#Testiranje jednakosti varijance savjesnosti

Pretpostavljam nezavisnost uzoraka i izvodim F test.

Hipoteze:

$$H_0: \sigma^2_{east Asia} = \sigma^2_{rest}  \\ H_1: \sigma^2_{east Asia} \neq \sigma^2_{rest}  $$
```{r}
var.test(east_asia$conscientiousness_score, rest_regions$conscientiousness_score)
```
Na osnovu male p vrijednosti odbacujem nultu hipotezu u korist alternative da su varijance distribucije različite


#Testiranje jednakosti razine savjesnosti

Koristim T test i pretpostavljam nezavisnost varijabli i različitost varijanci.

Hipoteze:

$$H_0: \mu_{eastAsia} = \mu_{rest}  \\ H_1: \mu_{eastAsia} > \mu_{rest}  $$

```{r}
t.test(east_asia$conscientiousness_score,rest_regions$conscientiousness_score, alt = "greater", var.equal = FALSE)

```
Uz veliku p vrijednost nisam uspio odbaciti nultu hipotezu i zaključujem nije opravdan mit o visokoj savjesnosti populacije istočne Azije.



####karakteristike prema spolu ispitanika
##1=male, 2=female
##članak na ovu temu(https://www.frontiersin.org/articles/10.3389/fpsyg.2011.00178/full)

Neuroticism
Neuroticism describes the tendency to experience negative emotion and related processes in response to perceived threat and punishment; these include anxiety, depression, anger, self-consciousness, and emotional lability. Women have been found to score higher than men on Neuroticism as measured at the Big Five trait level, as well as on most facets of Neuroticism included in a common measure of the Big Five, the NEO-PI-R (Costa et al., 2001). Additionally, women also score higher than men on related measures not designed specifically to measure the Big Five, such as indices of anxiety (Feingold, 1994) and low self-esteem (Kling et al., 1999). The one facet of Neuroticism in which women do not always exhibit higher scores than men is Anger, or Angry Hostility (Costa et al., 2001)

```{r}
male_subjects = bigfive[bigfive$sex == 1 ,]
female_subjects = bigfive[bigfive$sex == 2 ,]
```

```{r}
cat('Srednja vrijednost neurocizma  za pripadnice ženskog spola je ', mean(female_subjects$neuroticism_score), '\n')
cat('Srednja vrijednost otvorenosti za pripadnike muškog spola je ', mean(male_subjects$neuroticism_score), '\n')
cat('Varijanca vrijednost neurocizma  za pripadnice ženskog spola je ', var(female_subjects$neuroticism_score), '\n')
cat('Varijanca vrijednost otvorenosti za pripadnike muškog spola je ', var(male_subjects$neuroticism_score), '\n')
```
```{r}

boxplot(male_subjects$neuroticism_score, female_subjects$neuroticism_score, 
        names = c('Male subjects\' neuroticism score','Female subjects\' neuroticism score'),
        main='Boxplot of male and female subjects\' neuroticism_score')

```


Na ovom skupo podataka možemo uočiti razliku u srednjoj vrijednosti neurocizma između pripadnika ženskog i muškog spola. Stoga postoje indikacije da bi neuroticism_score trebao biti viši kod žena nego muškaraca.

Sljedeći korak je provjeriti normalnost podataka koju najčešće provjeravamo: histgoramom, qq-plotom te KS-testom (kojim provjeravamo pripadnost podataka distribuciji).

```{r, fig.width = 14, fig.height=5}
hist(male_subjects$neuroticism_score,main='Male neuroticsm score histogram', xlab='value', ylab='Frequency')
hist(female_subjects$neuroticism_score,main='Female neuroticsm score histogram', xlab='value', ylab='Frequency')
```

Histogrami upućuju na normalnost podataka. Normalnost možemo još provjeriti i qqplot-ovima ili testom koji ispituje normalnost.

```{r}
qqnorm(male_subjects$neuroticism_score, pch = 1, frame = FALSE,main='Male subjects')
qqline(male_subjects$neuroticism_score, col = "steelblue", lwd = 2)

qqnorm(female_subjects$neuroticism_score, pch = 1, frame = FALSE,main='Female subjects')
qqline(female_subjects$neuroticism_score, col = "steelblue", lwd = 2)
```


```{r}
var(male_subjects$neuroticism_score)
var(female_subjects$neuroticism_score)
```
#Testiranje normalnosti distribucije neuroitcizma

Hipoteze:

H_0: distribucija male_subjects$neuroticism_score pripada eksponencijalnoj razdiobi
H_1: distribucija male_subjects$neuroticism_score NE pripada eksponencijalnoj razdiobi

```{r}
lillie.test(male_subjects$neuroticism_score)
```
Odbacujem nultu hipotezu u korist alternative da se neuroticizam muških ispitanaika ravna po normalnoj distribuciji.

Hipoteze:

H_0: distribucija female_subjects$neuroticism_score pripada eksponencijalnoj razdiobi
H_1: distribucija female_subjects$neuroticism_score NE pripada eksponencijalnoj razdiobi

```{r}
lillie.test(female_subjects$neuroticism_score)
```
Odbacujem nultu hipotezu u korist alternative da se neuroticizam ženskih ispitanica ravna po normalnoj distibuciji.


#Testiranje jednakosti varijance neuroticizma

Pretpostavljam nezavisnost uzoraka i izvodim F test.

Hipoteze:

$$H_0: \sigma^2_{Male} = \sigma^2_{Female}  \\ H_1: \sigma^2_{Male} \neq \sigma^2_{Female}  $$
```{r}
var.test(male_subjects$neuroticism_score, female_subjects$neuroticism_score)
```
Na osnovu male p vrijednosti odbacujem nultu hipotezu u korist alternative da su varijance distribucije različite

#Testiranje jednakosti razine savjesnosti

Koristim T test i pretpostavljam nezavisnost varijabli i različitost varijanci.

Hipoteze:

$$H_0: \mu_{Female} = \mu_{Male}  \\ H_1: \mu_{Female} > \mu_{male}  $$

```{r}
t.test(female_subjects$neuroticism_score ,male_subjects$neuroticism_score, alt = "greater", var.equal = FALSE)

```
p-vrijednost je manja od 0.05, stoga se hipoteza \( H_0: \mu_{Female} = \mu_{Male} \) odbacuje u korist alternativne hipoteze \(H_1: \mu_{female} > \mu_{Male}  \)
