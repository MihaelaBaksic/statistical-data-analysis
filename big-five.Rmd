---
title: "Big Five – velikih pet dimenzija ličnosti"
author: "Filip Grebenar, David Konjevod, Lovre Mitrović, Mihaela Bakšić"
subtitle: Projekt iz predmeta Statistička analiza podataka, Fakultet elektrotehnike i računarstva
output:
  html_document:
    df_print: paged
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
```


# Uvod

// TODO

```{r}

bigfive = read.csv("./big_five_scores.csv")
head(bigfive)

```
```{r}
View(bigfive)
```
```{r}
summary(bigfive)
```



## Testiranje razlika u otvorenosti kod mladih i starih ispitanika

Često je prisutna pretpostavka kako su mladi ljudi otvoreniji novim iskustvima od starih. Stoga, provest će se testiranje te pretpostavke. Mladim ljudima smatrat će se svi stari 30 ili manje godina, dok će se starim ljudima smatrati oni stari 60 ili više godina.

```{r}

cat('Medijan godina svih ispitanika je ', median(bigfive$age),'\n')

old_subjects = bigfive[bigfive$age >= 60 ,]
young_subjects = bigfive[bigfive$age <= 30 ,]

cat('Srednja vrijednost otvorenosti za mlade ( <= 30 godina ) ispitanike je ', mean(young_subjects$openness_score), '\n')
cat('Srednja vrijednost otvorenosti za stare ( >= 60 godina ) ispitanike je ', mean(old_subjects$openness_score), '\n')
cat('Varijanca otvorenosti za mlade ( <= 30 godina ) ispitanike je ', var(young_subjects$openness_score), '\n')
cat('Varijanca otvorenosti za stare ( >= 60 godina ) ispitanike je ', var(old_subjects$openness_score), '\n')

boxplot(old_subjects$openness_score, young_subjects$openness_score, 
        names = c('Older subjects\' openness score','Younger subjects\' openness score'),
        main='Boxplot of younger and older subjects\' openness score')


hist(bigfive$openness_score,main='Openness score histogram',xlab='Value',ylab='Frequency', breaks=100)


```

# Normalnost podataka - grafovi
```{r}

hist(old_subjects$openness_score,main='Openness score old subjects histogram',xlab='Value',ylab='Frequency', breaks=100)
hist(young_subjects$openness_score,main='Openness score young subjects histogram',xlab='Value',ylab='Frequency', breaks=100)

qqnorm(old_subjects$openness_score, pch = 1, frame = FALSE,main='Older subjects')
qqline(old_subjects$openness_score, col = "steelblue", lwd = 2)

qqnorm(young_subjects$openness_score, pch = 1, frame = FALSE,main='Younger subjects')
qqline(young_subjects$openness_score, col = "steelblue", lwd = 2)

```
Iz histograma i qq-plotova za openness_score mladih i starih ispitanika može se naslutiti kako podaci pripadaju normalnoj razdiobi. Ta pretpostavka pokušat će se dodatno potvrditi provođenjem Lillieforsove inačice Kolmogorov-Smirnovljevog testa. Za sve testove koristi se razina značajnosti \(\alpha = 0.05\).

# Testiranje normalnosti - Lillieforsova inačica Kolmogomorov-Smirnovljevog testa


Testiranje normalnosti otvorenosti za starije ispitanike
```{r}
lillie.test(old_subjects$openness_score)

```
S obzirom da je p-vrijednost = 0.000517 < \(\alpha\), nulta hipoteza o pripadnosti podataka o otvorenosti starih ispitanika normalnoj raspodjeli se odbacije u korist alternativne hipoteze.

Testiranje normalnosti faktora otvorenosti za mlađe ispitanike
```{r}
lillie.test(young_subjects$openness_score)
```

S obzirom da je p-vrijednost < 2.2e-16 < \(\alpha\), nulta hipoteza o pripadnosti podataka o otvorenosti mladih ispitanika normalnoj raspodjeli se odbacije u korist alternativne hipoteze.


# Testiranje jednakosti varijanci otvorenosti za stare i mlade ispitanike

Testiranje jednakosti varijanci provodi se F testom. Pretpostavlja se nezavisnost uzoraka.

Hipoteze:

$$H_0: \sigma^2_{old} = \sigma^2_{young}  \\ H_1: \sigma^2_{old} \neq \sigma^2_{young}  $$
```{r}
var.test(old_subjects$openness_score, young_subjects$openness_score)
```
S obzirom da je p-vrijednost =  2.084e-06 < \(alpha\)odbacujemo hipotezu \(H_0 : \sigma^2_{old} = \sigma^2_{young} \) u korist alternativne hipoteze \( H_1: \sigma^2_{old} \neq \sigma^2_{young} \). Zaključujemo da podatci govore u prilog alternativnoj hipotezi i u testovima koji slijede koristit će se informacija o nejednakosti varijanci dobivena ovim testom.

# Testiranje jednakosti srednjih vrijednosti otvorenosti za stare i mlade ispitanike

Testiranje jednakosti srednjih vrijednosti T testom zahtjeva da podaci dolaze iz normalne razdiobe. Prethodno provedenim Lillieforsovim testom normalnosti pokazalo se da to ne vrijedi niti za podatke o otvorenosti mladih niti starih ispitanika. Ipak, s obzirom da histogrami i qq-plot grafovi govore u prilog normalnosti. Uzevši u obzir oblik grafova i veliku osjetljivost Lillieforstovog testa normalnosti, možemo nastaviti testiranje uz pretpostavku normalnosti podataka.


Testiranje jednakosti srednjih vrijednosti otvorenosti za stare i mlade ispitanike provodi se kao T test za podatke s različitim varijancama, kako je pokazano prethodnim testom. Pretpostavlja se nezavisnost uzoraka.

Hipoteze:

$$H_0: \mu_{old} = \mu_{young}  \\ H_1: \mu_{old} \neq \mu_{young}  $$

```{r}
t.test(old_subjects$openness_score, young_subjects$openness_score, alt = "two.sided", var.equal = FALSE)

```
p-vrijednost = 0.00163 < \(\alpha\), stoga se hipoteza \( H_0: \mu_{old} = \mu_{young} \) odbacuje u korist alternativne hipoteze \(H_1: \mu_{old} \neq \mu_{young}\). 


Statističkim testiranjem pokazano je kako postoji statistički značajna razlika između srednjih vrijednosti otvorenosti mladih i starih ispitanika.



## Model linearne regresije za modeliranja odnosa godina i otvorenosti kod ispitanika


S obzirom na činjenicu da smo prethodnim testovima pokazali da je razlika između srednjih vrijednosti otvorenosti za mlade i stare ispitanike statistički značajna, vrijedilo bi se pozabaviti pitanjem odnosa između varijabli godina (age) i otvorenosti (openness_score). Za modeliranje ovisnosti koristi se model linearne regresije. Kako bi se dobio dojam o mogućoj zavisnosti varijable koja ocjenjuje otvorenost ispitanika i njihovih godina, prikazan je grafički prikaz u obliku scatter-plota.

```{r}
plot(bigfive$age,bigfive$openness_score)
```
Ipak, na temelju izgleda grafa moglo bi se zaključiti da veza između varijabli ne postoji ili nije statistički značajna. Kako bi se moglo preciznije diskutirati o tom pitanju, nastavit će se s modeliranjem njihvog odnosa modelom linearne regresije i provođenjem testova nad modelom, unatoč sugestiji grafičkog prikaza da je korelacija između varijabli vrlo slaba. Na temelju ocjene sposobnosti modela linearne regresije da modelira prikupljene podatke, ocjenit će se i njihova linearna zavisnost. Izlazna varijabla u modelu je openness_score, dok je varijabla age regresor. S obzirom da je priutan samo jedan regresor, koristi se jednostavna linearna regresija.

```{r}

selected.model = lm(openness_score~age,data=bigfive)

plot(bigfive$age,bigfive$openness_score)
lines(bigfive$openness_score, selected.model$fitted.values, col='red')

```

### Provjera pretpostavki modela

Prije svega treba provjeriti pretpostavke modela. Prva pretpostavka modela linearne regresije je da su reziduali normalno distribuirani i imaju homogenu varijancu. S obzirom da je korišten model jednostavne regresije, nije potrebno baviti se pretpostavkom o slaboj međusobnoj koreliranosti regresora.

```{r}

hist(rstandard(selected.model), breaks=100)

qqnorm(rstandard(selected.model))
qqline(rstandard(selected.model))

```
Histogram reziduala je vrlo obečavajuć te snažno podupire pretpostavku o normalnosti reziduala. Ipak, potrebno je provesti i Lillieforsovu inačicu KS testa kako bi se normalnost insinuirana histogramom potvrdila.

```{r}

lillie.test(rstandard(selected.model))

```
S obzirom da je p-vrijednost < \(\alpha\), nulta hipoteza o normalnosti standardiziranih reziduala se odbija u korist alternativnoj hipotezi. S obzirom na osjetljivost Lillieforsovog testa, izgled histograma i robusnost T-testa, ipak se može govoriti o dovoljnoj normalnosti reziduala za daljnja testiranja.


Za ocjenu kvalitete modela koristi se koeficjent determinacije \(R^2\), koji odgovara udjelu varijance zavisne varijable koju objašnjava dani model.


```{r}
summary(selected.model)
```

\(R^2\) za procjenjeni model iznosi 0.0003563, što je izrazito niska vrijednost. Također, p-vrijednost za F-test signifikantnosti modela je daleko ispod \(\alpha\). Uzimajući ove dvije ocjene u obzir, možemo sa velikom sigurnošću tvrditi kako je model linearne regresije neadekvatan odabir za modeliranje odnosa između godina i otvorenosti ispitanika. S obzirom na izgled scatter plota odnosa te dvije varijable, može se reći da je rezultat i očekivan.


#Savjesnost između regija
##Uvod

U ovom dijelu bavimo se pitanjem imaju li neke regije značajno različite rezultate u određenom faktoru. Primjerice je li opravdan mit o visokoj savjesnosti populacije istočne Azije naspram populacije drugih kontinenata.

Regije sam podijelio na osnovu UN-ove podjele (izvor:"https://unstats.un.org/sdgs/indicators/regional-groups/").

```{r}

`%!in%` <- Negate(`%in%`)

region_east_asian =c('Brunei','Cambodia','China','Hong Kong','Indonesia','Japan','Macau', 'Malaysia', 'Mongolia','Burma(Myan','North Kore', 'Philippine','Singapore','South Kore','Burma', 'Thailand','Vietnam', 'Taiwan','Borneo')

east_asia = bigfive[bigfive$country %in% region_east_asian,]

rest_regions = bigfive[bigfive$country %!in% region_east_asian,]

summary(bigfive$conscientiousness_score)
summary(east_asia$conscientiousness_score)
summary(rest_regions$conscientiousness_score)

cat('Varijanca savjesnosti za istočnu aziju ', var(east_asia$conscientiousness_score), '\n')
cat('Varijanca savjesnosti za ostatak svijeta ', var(rest_regions$conscientiousness_score), '\n')

boxplot(east_asia$conscientiousness_score, rest_regions$conscientiousness_score, 
        names = c('Istočna Azija\ savjesnost','Ostatak svijeta savjesnost'),
        main='Boxplot za istočnu Aziju i ostatak svijeta savjesnost')


hist(bigfive$conscientiousness_score,main='Savjesnost histogram',xlab='Value',ylab='Frequency', breaks=100)

```

```{r}

hist(east_asia$conscientiousness_score,main='Histogram savjesnosti istočne Azije',xlab='Value',ylab='Frequency', breaks=100)
hist(rest_regions$conscientiousness_score,main='Histogram savjesnosti ostatka svijeta',xlab='Value',ylab='Frequency', breaks=100)

qqnorm(east_asia$conscientiousness_score, pch = 1, frame = FALSE,main='Istočna Azija')
qqline(east_asia$conscientiousness_score, col = "steelblue", lwd = 2)

qqnorm(rest_regions$conscientiousness_score, pch = 1, frame = FALSE,main='Ostatak svijeta')
qqline(rest_regions$conscientiousness_score, col = "steelblue", lwd = 2)

```
Već iz priloženih grafova mogu naslutiti da su obje distribucije normalne, da je rasipanje veće kod populacije istočne Azije nego u ostatku svijeta (pretpostavljam da je to najviše zbog činjenice da je set podataka za ostatak svijeta mnogo veći) te suprotno početnom pitanju izgleda da je savjesnost ispitanika istočne Azije manja nego u ostatku svijeta.

##Testiranje normalnosti distribucije

Hipoteze:

H_0: distribucija east_asia$conscientiousness_score pripada normalnoj razdiobi
H_1: distribucija east_asia$conscientiousness_score NE pripada normalnoj razdiobi

```{r}
lillie.test(east_asia$conscientiousness_score)
```
Odbacujem nultu hipotezu u korist alternative da se savjesnost ispitanaika istočne Azije ne ravna po normalnoj distribuciji.

Hipoteze:

H_0: distribucija rest_regions$conscientiousness_score pripada normalnoj razdiobi
H_1: distribucija rest_regions$conscientiousness_score NE pripada normalnoj razdiobi

```{r}
lillie.test(rest_regions$conscientiousness_score)
```
Odbacujem nultu hipotezu u korist alternative da se savjesnost ispitanika iz ostalih regija ne ravna po normalnoj distibuciji.

Uzevši u obzir preveliku osjetljivost ovog testa i činjenicu da je iz histograma vidljiva normalnost u nastavku pretpostavljam normalnost za obje populacije.

##Testiranje jednakosti varijance savjesnosti

Pretpostavljam nezavisnost uzoraka i izvodim F test.

Hipoteze:

$$H_0: \sigma^2_{east Asia} = \sigma^2_{rest}  \\ H_1: \sigma^2_{east Asia} \neq \sigma^2_{rest}  $$
```{r}
var.test(east_asia$conscientiousness_score, rest_regions$conscientiousness_score)
```
Na osnovu male p vrijednosti odbacujem nultu hipotezu u korist alternative da su varijance distribucije različite


##Testiranje jednakosti razine savjesnosti

Koristim T test i pretpostavljam nezavisnost varijabli i različitost varijanci te normalnu razdiobu.

Hipoteze:

$$H_0: \mu_{eastAsia} = \mu_{rest}  \\ H_1: \mu_{eastAsia} > \mu_{rest}  $$

```{r}
t.test(east_asia$conscientiousness_score,rest_regions$conscientiousness_score, alt = "greater", var.equal = FALSE)

```
Uz veliku p vrijednost nisam uspio odbaciti nultu hipotezu i zaključujem nije opravdan mit o visokoj savjesnosti populacije istočne Azije.

##Savjesnost između više regija
###Uvod

Pošto se nisam uvjerio u ispravnost mita da su stanovnici istočne Azije savjesniji od ostatka svijeta pitam postoji li uopće razlike u savjesnosti između stavnika različitih regija. Za primjer ću uzeti pet regija za koje imam sličan broj podataka. Moje pitanje glasi: "Postoji li razlika u savjesnosti između stavnovnika Zapada, latinske Amerike, južne Afrike, sjeverne Afrike i zapadne Azije(arapskog svijeta) i centralne Azije"
```{r}
region_west = c('UK', 'USA', 'Denmark', 'Sweden', 'Iceland', 'Canada', 'Finland', 'Croatia', 'Portugal', 'Yugoslavia', 'Germany', 'Ireland', 'Belarus', 'Djibouti', 'Bulgaria', 'Spain', 'Switzerlan', 'Slovakia', 'Norway', 'France', 'Romania', 'Malta', 'Cyprus', 'Netherland', 'Belgium', 'Macedonia', 'Ukraine', 'Greece', 'Andorra', 'Latvia', 'Albania', 'Austria', 'Russian Fe', 'Poland', 'Italy', 'Estonia', 'Serbia', 'Slovenia', 'Bosnia Her', 'Hungary', 'Northern M', 'Bermuda', 'Lithuania', 'Gibraltar', 'Czech Repu', 'Monaco', 'Moldova', 'Vatican Ci', 'Luxembourg', 'Greenland', 'Vatican', 'Falkland I', 'San Marino', 'Liechtenst')

region_latin_america = c('Argentina', 'Anguilla', 'Trinidad a', 'Chile', 'Mexico', 'Brazil', 'Bahamas', 'Haiti', 'Cayman Isl', 'Puerto Ric', 'British Vi', 'Columbia', 'Ecuador', 'Peru', 'Venezuela', 'Aruba', 'Cuba', 'Antigua', 'Suriname', 'Dominican', 'Costa Rica', 'Jamaica', 'Grenada', 'El Salvado', 'Honduras', 'St Lucia', 'Barbados', 'Virgin Isl', 'Panama', 'Belize', 'Guatemala', 'Guyana', 'Paraguay', 'Gabon', 'Uruguay', 'Faeroe Isl', 'Bolivia', 'Nicaragua', 'Turks and', 'Dominica', 'French Gui', 'Saint Kitt', 'Guadeloupe', 'St Vincent', 'Gambia')

region_south_africa = c('South Afri', 'Burundi', 'Uganda', 'Cape Verde', 'Angola', 'Lesotho', 'Mauritius', 'Central Af', 'Benin', 'Nigeria', 'Ghana', 'Kenya', 'Zimbabwe', 'Cameroon', 'Mozambique', 'Namibia', 'Somalia', 'Zambia', 'Ivory Coas', 'Ethiopia', 'Seychelles', 'Rwanda', 'Niger', 'Mali', 'Togo', 'Botswana', 'Burkina Fa', 'Congo', 'Malawi', 'Senegal', 'Chad', 'Liberia', 'Eritrea', 'Swaziland')

region_north_africa_and_west_asia = c('Syria', 'Egypt', 'Turkey', 'Algeria', 'Kuwait', 'Israel', 'Lebanon', 'Arabian Gu', 'Georgia', 'Saudi Arab', 'Azerbaijan', 'Jordan', 'Iraq', 'Tunisia', 'Bahrain', 'United Ara', 'Sudan', 'Oman', 'Armenia', 'Yemen', 'Qatar', 'Morocco', 'Western Sa', 'Libyan Ara')

region_central_asia = c('India', 'Afghanista', 'Bangladesh', 'Pakistan', 'Iran', 'Turkmenist', 'Nepal', 'Sri Lanka', 'Bhutan', 'Kazakhstan', 'Maldives', 'Uzbekistan')

region_oceania = c('Australia', 'New Zealan', 'Cocos (Kee', 'Guam')

west = bigfive[bigfive$country %in% region_west,]
latin_america = bigfive[bigfive$country %in% region_latin_america,]
africa = bigfive[bigfive$country %in% region_south_africa,]
arabic_world = bigfive[bigfive$country %in% region_north_africa_and_west_asia,]
central_asia = bigfive[bigfive$country %in% region_central_asia,]
oceania = bigfive[bigfive$country %in% region_oceania,]
```
```{r}
summary(west$conscientiousness_score)
summary(latin_america$conscientiousness_score)
summary(africa$conscientiousness_score)
summary(arabic_world$conscientiousness_score)
summary(central_asia$conscientiousness_score)

boxplot(west$conscientiousness_score,latin_america$conscientiousness_score,africa$conscientiousness_score,arabic_world$conscientiousness_score,central_asia$conscientiousness_score, 
        names = c('Zapad','Latinska amerika','Afrika','Arapski svijet','Centralna\n Azija'),
        main='Boxplot savjesnosti za zadane regije')

```


```{r}

hist(west$conscientiousness_score,main='Histogram savjesnosti Zapada',xlab='Value',ylab='Frequency', breaks=100)
qqnorm(west$conscientiousness_score, pch = 1, frame = FALSE,main='Savjesnost Zapada')
qqline(west$conscientiousness_score, col = "steelblue", lwd = 2)

hist(latin_america$conscientiousness_score,main='Histogram savjesnosti Latinske Amerike',xlab='Value',ylab='Frequency', breaks=100)
qqnorm(latin_america$conscientiousness_score, pch = 1, frame = FALSE,main='Savjesnost Latinske Amerike')
qqline(latin_america$conscientiousness_score, col = "steelblue", lwd = 2)

hist(africa$conscientiousness_score,main='Histogram savjesnosti Afrike',xlab='Value',ylab='Frequency', breaks=100)
qqnorm(africa$conscientiousness_score, pch = 1, frame = FALSE,main='Savjesnost Afrike')
qqline(africa$conscientiousness_score, col = "steelblue", lwd = 2)

hist(arabic_world$conscientiousness_score,main='Histogram savjesnosti Arapskog svijeta',xlab='Value',ylab='Frequency', breaks=100)
qqnorm(arabic_world$conscientiousness_score, pch = 1, frame = FALSE,main='Savjesnost Arapski svijet')
qqline(arabic_world$conscientiousness_score, col = "steelblue", lwd = 2)

hist(central_asia$conscientiousness_score,main='Histogram savjesnosti centralne Azije',xlab='Value',ylab='Frequency', breaks=100)
qqnorm(central_asia$conscientiousness_score, pch = 1, frame = FALSE,main='Savjesnost centralne Azije')
qqline(central_asia$conscientiousness_score, col = "steelblue", lwd = 2)
```

Iz histograma i qq plota je vidljivo da se savjesnost svih regija ravna po normalnoj razdiobi.

###Testiranje normalnosti distribucije

Hipoteze:

H_0: distribucija regije pripada normalnoj razdiobi
H_1: distribucija regije NE pripada normalnoj razdiobi

```{r test normalnosti}
lillie.test(west$conscientiousness_score)
lillie.test(latin_america$conscientiousness_score)
lillie.test(africa$conscientiousness_score)
lillie.test(arabic_world$conscientiousness_score)
lillie.test(central_asia$conscientiousness_score)
```
Za savjesnost svake regije na Lillieforovom testu smo dobili izuzetno malenu p vrijednost te odbacujemo nultu hipotezu za svaku regiju. Zaključak na osnovu Lillieforova testa jest da se nijedna distribucija savjesnosti ne ravna po normalnoj razdiobi. Ali na osnovu histograma i qq plota u nastavku pretpostavljamo da se svaka distibucija savjesnosti ravna po normalnoj razdiobi.

###Testiranje homogenosti varijance između populacija

Nulta hipoteza je da su varijance savjesnosti svih regija jednake. Alternativa je da nisu odnosno da se barem jedan par varijanci nije jednak.

$$ \begin{aligned}
  H_0 & : \sigma_1^2 = \sigma_2^2 = \sigma_3^2 = \sigma_4^2 = \sigma_5^2 \\
  H_1 & : \neg H_0.
\end{aligned} $$

Za testiranje ove hipoteze koristimo Bartlettov test.

```{r test pretpostavki - homogenost varijanci}

score = c(latin_america$conscientiousness_score,arabic_world$conscientiousness_score,central_asia$conscientiousness_score)

west_vec = rep(c("west"),length(west$conscientiousness_score))
la_vec = rep(c("latin_america"),length(latin_america$conscientiousness_score))
afr_vec = rep(c("africa"),length(africa$conscientiousness_score))
arb_vec = rep(c("arabic_world"),length(arabic_world$conscientiousness_score))
asi_vec = rep(c("central_asia"),length(central_asia$conscientiousness_score))

region = c(la_vec,arb_vec,asi_vec)

df = data.frame(region,score)

bartlett.test(df$score ~ df$region)

var(west$conscientiousness_score)
var(latin_america$conscientiousness_score)
var(africa$conscientiousness_score)
var(arabic_world$conscientiousness_score)
var(central_asia$conscientiousness_score)
```
U nastavku pretpostavljam homegenost varijanci.

###Testiranje jednakosti savjesnosti

Provjeravamo postoje li razlike u savjesnosti.

$$ \begin{aligned}
  H_0 & : \mu_1^2 = \mu_2^2 = \mu_3^2 = \mu_4^2 = \mu_5^2 \\
  H_1 & : \neg H_0.
\end{aligned} $$

```{r test anova - jednakost savjesnosti}
# Test
a = aov(df$score ~ df$region)
summary(a)
```

```{r}

nrow(west)
nrow(latin_america)
nrow(africa)
nrow(arabic_world)
nrow(central_asia)
nrow(oceania)
nrow(east_asia)
```
#karakteristike prema spolu ispitanika
##1=male, 2=female
##članak na ovu temu(https://www.frontiersin.org/articles/10.3389/fpsyg.2011.00178/full)

Neuroticism
Neuroticism describes the tendency to experience negative emotion and related processes in response to perceived threat and punishment; these include anxiety, depression, anger, self-consciousness, and emotional lability. Women have been found to score higher than men on Neuroticism as measured at the Big Five trait level, as well as on most facets of Neuroticism included in a common measure of the Big Five, the NEO-PI-R (Costa et al., 2001). Additionally, women also score higher than men on related measures not designed specifically to measure the Big Five, such as indices of anxiety (Feingold, 1994) and low self-esteem (Kling et al., 1999). The one facet of Neuroticism in which women do not always exhibit higher scores than men is Anger, or Angry Hostility (Costa et al., 2001)

```{r}
male_subjects = bigfive[bigfive$sex == 1 ,]
female_subjects = bigfive[bigfive$sex == 2 ,]
```

```{r}
cat('Srednja vrijednost neurocizma  za pripadnice ženskog spola je ', mean(female_subjects$neuroticism_score), '\n')
cat('Srednja vrijednost otvorenosti za pripadnike muškog spola je ', mean(male_subjects$neuroticism_score), '\n')
cat('Varijanca vrijednost neurocizma  za pripadnice ženskog spola je ', var(female_subjects$neuroticism_score), '\n')
cat('Varijanca vrijednost otvorenosti za pripadnike muškog spola je ', var(male_subjects$neuroticism_score), '\n')
```
```{r}

boxplot(male_subjects$neuroticism_score, female_subjects$neuroticism_score, 
        names = c('Male subjects\' neuroticism score','Female subjects\' neuroticism score'),
        main='Boxplot of male and female subjects\' neuroticism_score')

```


Na ovom skupo podataka možemo uočiti razliku u srednjoj vrijednosti neurocizma između pripadnika ženskog i muškog spola. Stoga postoje indikacije da bi neuroticism_score trebao biti viši kod žena nego muškaraca.

Sljedeći korak je provjeriti normalnost podataka koju najčešće provjeravamo: histgoramom, qq-plotom te KS-testom (kojim provjeravamo pripadnost podataka distribuciji).

```{r, fig.width = 14, fig.height=5}
hist(male_subjects$neuroticism_score,main='Male neuroticsm score histogram', xlab='value', ylab='Frequency')
hist(female_subjects$neuroticism_score,main='Female neuroticsm score histogram', xlab='value', ylab='Frequency')
```

Histogrami upućuju na normalnost podataka. Normalnost možemo još provjeriti i qqplot-ovima ili testom koji ispituje normalnost.

```{r}
qqnorm(male_subjects$neuroticism_score, pch = 1, frame = FALSE,main='Male subjects')
qqline(male_subjects$neuroticism_score, col = "steelblue", lwd = 2)

qqnorm(female_subjects$neuroticism_score, pch = 1, frame = FALSE,main='Female subjects')
qqline(female_subjects$neuroticism_score, col = "steelblue", lwd = 2)
```


```{r}
var(male_subjects$neuroticism_score)
var(female_subjects$neuroticism_score)
```
#Testiranje normalnosti distribucije neuroitcizma

Hipoteze:

H_0: distribucija male_subjects$neuroticism_score pripada normalnoj razdiobi
H_1: distribucija male_subjects$neuroticism_score NE pripada normalnoj razdiobi

```{r}
lillie.test(male_subjects$neuroticism_score)
```
Odbacujem nultu hipotezu u korist alternative da se neuroticizam muških ispitanaika ravna po normalnoj distribuciji.

Hipoteze:

H_0: distribucija female_subjects$neuroticism_score pripada normalnoj razdiobi
H_1: distribucija female_subjects$neuroticism_score NE pripada normalnoj razdiobi

```{r}
lillie.test(female_subjects$neuroticism_score)
```
Odbacujem nultu hipotezu u korist alternative da se neuroticizam ženskih ispitanica ravna po normalnoj distibuciji.


#Testiranje jednakosti varijance neuroticizma

Pretpostavljam nezavisnost uzoraka i izvodim F test.

Hipoteze:

$$H_0: \sigma^2_{Male} = \sigma^2_{Female}  \\ H_1: \sigma^2_{Male} \neq \sigma^2_{Female}  $$
```{r}
var.test(male_subjects$neuroticism_score, female_subjects$neuroticism_score)
```
Na osnovu male p vrijednosti odbacujem nultu hipotezu u korist alternative da su varijance distribucije različite

#Testiranje jednakosti razine savjesnosti

Koristim T test i pretpostavljam nezavisnost varijabli i različitost varijanci.

Hipoteze:

$$H_0: \mu_{Female} = \mu_{Male}  \\ H_1: \mu_{Female} > \mu_{male}  $$

```{r}
t.test(female_subjects$neuroticism_score ,male_subjects$neuroticism_score, alt = "greater", var.equal = FALSE)

```
p-vrijednost je manja od 0.05, stoga se hipoteza \( H_0: \mu_{Female} = \mu_{Male} \) odbacuje u korist alternativne hipoteze \(H_1: \mu_{female} > \mu_{Male}  \)




##Motivacija: Možemo li zaključiti nešto o jednoj osobini uzimajući kao ulazne varijable jednu ili više ostalih osobina?

Ono što pritom očekujemo je da ne bi smjela postojati visoka korelacija između pojedinih osobina ličnosti pošto svaka od njih na jedinstven način opisuje određeni element ljudske osobnosti. Uz ovih 5, poznat je i velik broj drugih osobina, ali ovih 5 je izabrano na način da u idealnom slučaju u potpunosti definiraju osobnost neke osobe i razlikuju je od osobnosti drugih pojedinaca.

Kao izlaznu varijablu proizvoljno smo odabrali neuroticizam, a pregledavajući znanstvenu literaturu došli smo do zaključka da bi ekstraverzija mogla u najvećoj mjeri objasniti varijaciju u neuroticizmu što i ima smisla jer osobe koje su introverti teže artikuliraju svoje emocije te su skloniji anksioznosti i depresiji.

Kako bismo mogli bolje uočiti potencijalnu vezu dviju varijabli, uzet ćemo poduzorak našeg ulaznog skupa.


```{r}
big_five_scores1 = big_five_scores[sample(nrow(big_five_scores),2000),]
smoothScatter(big_five_scores$extraversion_score, big_five_scores$neuroticism_score)
plot(big_five_scores1$extraversion_score, big_five_scores1$neuroticism_score)


```

Scatter plot pokazuje da postoji negativan efekt varijable extraversion_score na izlaznu varijablu neuroticism_score. Zato ćemo pokušati kreirati model jednostavne regresije koji uključuje spomenute varijable:
$$Y = \beta_0 + \beta_1x_1 + \epsilon$$
Pritom pretostavljamo da je epsilon normalno distribuirana slučajna varijabla (pogreška) s homogenom i nezavisnom varijancom.

```{r}
fit.neuroticism = lm(neuroticism_score ~ extraversion_score, data = big_five_scores1)
plot(big_five_scores1$extraversion_score, big_five_scores1$neuroticism_score)
lines(big_five_scores1$extraversion_score, fit.neuroticism$fitted.values, col = "red")

```

##Provjera pretpostavki

Sada ćemo provjeriti pretpostavke o normalnosti reziduala i homogenosti varijance. To ćemo učiniti grafički pomoću histograma i q-q plota te statističkim testovima - Kolmogorov-Smirnovljev test i Lillieforsova korekcija.

```{r}
#grafički prikazi


hist(rstandard(fit.neuroticism), probability = TRUE, breaks = 30) 

y <- seq(min(rstandard(fit.neuroticism)), max(rstandard(fit.neuroticism)), 0.01)
lines(y, dnorm(y, mean(rstandard(fit.neuroticism)), sd(rstandard(fit.neuroticism))), col = "red", lwd = 3) # Iz histograma se može naslutiti normalna distribucija. Vidimo da se graf funkcije gustoće vjerojatnosti normalne slučajne varijable s parametrima uzoračke distribucije prilično dobro podudara s funkcijom gustoće vjerojatnosti varijable neuroticism_score.

qqnorm(rstandard(fit.neuroticism))  
qqline(rstandard(fit.neuroticism)) # q-q plot pokazuje da se kvantili uzoračke distribucije u velikoj mjeri slažu s teorijskim kvantilima normalne distribucije. U repovima distribucije postoje manja odstupanja što možemo objasniti mogućim postojanjem outliera.

plot(fit.neuroticism$fitted.values,fit.neuroticism$residuals)  #nema naznake nehomogenosti pogreške
```

```{r}
#normalnost reziduala - statistički testovi

ks.test(rstandard(fit.neuroticism), "pnorm")
require(nortest)
lillie.test(rstandard(fit.neuroticism))
shapiro.test(rstandard(fit.neuroticism))
```

Iz p vrijednost KS-testa možemo zaključiti da uz nivo značajnosti od 5% ne možemo odbaciti nultu hipotezu o normalnosti, dok iz Lillieforsove inačice možemo zaključiti da uz isti nivo značajnosti možemo odbaciti nultu hipotezu. U ovom slučaju, pošto testiramo populaciju nepoznatog očekivanja i varijance, veću važnost pridajemo drugom testu koji je ujedno i stroži od KS testa. Pošto su t-testovi koji se koriste u analizi regresijskog modela robusni na nenormalnost, a i pošto p vrijednost koju testom dobijemo nije daleko od razine značajnosti možemo nastaviti dalje s regresijskom analizom.

```{r}
summary(fit.neuroticism)
# t-test --> koeficijenti su signifikantni
# f-test --> Cijeli model je signifikantan
# zaključak o R2?
```

Osim ekstraverzije kao potencijalne osobine iz koje bismo mogli nešto zaključiti o neuroticizmu osobe, pokazalo se da bi još jedna osobina u Big Five modelu mogla objašnjavati rezultat koji osoba postiže na neuroticizmu, a to je savjesnost. To možemo interpretirati time da osobe koje su nediscplinirane, neuredne i nemaju rutinu mogu biti sklonije neurotičnom ponašanju od savjesnih i organiziranih ljudi.


```{r}
plot(big_five_scores1$conscientiousness_score, big_five_scores1$neuroticism_score)
smoothScatter(big_five_scores$conscientiousness_score, big_five_scores$neuroticism_score)

```

Iz scatter plota možemo uočiti naznaku negativne korelacije, odnosno zavisnosti dviju varijabli što odgovara našoj početnoj tezi. Kako bismo kvantificirali navedenu korelaciju, možemo izračunati Pearsonov korelacijski koeficijent za ove dvije varijable, a dodatno možemo pogledati korelacijsku tablicu svih 5 faktora što će nam pomoći i u kreiranju modela višestruke regresije i provjere njenih prepostavki.


```{r}

correlations <- cor(cbind(big_five_scores1$agreeable_score,big_five_scores1$extraversion_score, big_five_scores1$openness_score, big_five_scores1$conscientiousness_score, big_five_scores1$neuroticism_score))

colnames(correlations) <- c("agreeable_score", "extraversion_score", "openness_score", "conscientiousness_score", "neuroticism_score")
rownames(correlations) <- c("agreeable_score", "extraversion_score", "openness_score", "conscientiousness_score", "neuroticism_score")

library(corrplot)
corrplot(correlations, method = "number")

cor.test(big_five_scores1$extraversion_score, big_five_scores1$neuroticism_score)

```
Iz korelacijske tablice naslućujemo da postoji određena veza između varijabli neuroticism_score i conscientiousness_score. Ono što također možemo uočiti je da nema kršenja pretpostavki, tj. da nema značajne korelacije između dviju varijabli extraversion_score i conscientiousness_score što nam ujedno pokazuje i t-test.

```{r}
plot(fit.multi$fitted.values, fit.multi$residuals)

hist(rstandard(fit.multi))
ks.test(rstandard(fit.multi), "pnorm")
lillie.test(rstandard(fit.multi))
```

Iz grafičkog prikaza i testova zaključujemo da nema kršenja pretpostavke normalnosti reziduala.

```{r}

fit.neuroticism_m = lm(neuroticism_score ~ extraversion_score + conscientiousness_score, big_five_scores)
summary(fit.neuroticism_m)
```
Iz modela multivarijantne regresije možemo uočiti da su svi koeficijenti signifikantni uz bilo koju razinu značajnosti. Također, koeficijent determinacije se povećao u odnosu na model jednostavne regresije što znači da je conscientiousness_score doprinio poboljšanju funkcije ovisnosti izlazne varijable o regresorima, odnosno da je veća proporcija varijacije varijable Y objašnjena ovim modelom u odnosu na prošli.


Možemo probati uključiti i preostala dva faktora u model.

```{r}
fit.multi = lm(neuroticism_score ~ extraversion_score + conscientiousness_score + agreeable_score + openness_score, big_five_scores[big_five_scores$age > 20,])
summary(fit.multi)

```
Vidimo da su opet svi koeficijenti signifikantni do na bilo koju razinu značajnosti. Povećanje koeficijenta determinacije postoji, ali je zanemarivo pa možemo zaključiti da dodani faktori ne objašnjavaju u značajnijoj mjeri neobjašnjenu varijaciju modela s postojeća dva faktora.
Najveći efekt na izlaznu varijablu imaju regresori extraversion_score i conscientiousness_score.
